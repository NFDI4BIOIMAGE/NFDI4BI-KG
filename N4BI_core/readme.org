#+title: NFDI4BIOIMAGE Knowledge Graph -- core section
#+author: Carsten Fortmann-Grote
#+dateCreated: [2025-05-14 Wed] 

In this document, we create a RDF graph for the NFDI4BIOIMAGE consortium based on the NFDI core ontology (https://nfdi.fiz-karlsruhe.de/ontology/3.0.1).

The first subject we create represent the consortium itself.

* Python code
:PROPERTIES:
:ID:       c90a39ee-274a-4895-a727-2b143101cb78
:END:
:PROPERTIES:
:ID:       6cf75b8d-721e-45d2-a549-ca20aabfc749
:header-args:python :session rdf :results output
:END:

#+begin_src python  :session rdf :results output
  from rdflib import Graph, BNode, Literal, URIRef, DC, FOAF, XSD, RDF, RDFS,  Namespace
  import pprint

  # This and Default namespaces
  nfdicore = Namespace("https://nfdi.fiz-karlsruhe.de/ontology/")

  graph = Graph(bind_namespaces='rdflib')
  graph.bind('nfdicore', nfdicore)

  n4bi = URIRef("https://nfdi4bioimage.de/rdf/node")
  graph.add((n4bi, RDF.type, nfdicore.NFDI_0001039))

  # Foundation date
  graph.add((n4bi, nfdicore.NFDI_0000136, Literal("2023-03-01", datatype=XSD.date)))

  # URL
  graph.add((n4bi, nfdicore.NFDI_0001008, Literal("https://nfdi4bioimage.de")))

  # Wikidata entry
  graph.add((n4bi, nfdicore.NFDI_0001006, URIRef("https://wikidata.org/entity/Q113500855")))

  # Description, long title
  graph.add((n4bi, DC.description, Literal("National Research Data Infrastructure for Microscopy and Bioimage Analysis", lang="en")))
  graph.add((n4bi, DC.description, Literal("Nationale Forschungsdateninfrastruktur f√ºr Mikroskopie und Bildanalyse", lang="de")))

  # Acronyms
  graph.add((n4bi, nfdicore.NFDI_0010015, Literal("N4BI")))
  graph.add((n4bi, nfdicore.NFDI_0010015, Literal("NFDI4BIOIMAGE")))

  graph.serialize("/home/grotec/Repositories/NFDI4BI-KG/RDF_dumps/n4bi_core.n3")

  print(len(graph))
#+end_src

#+RESULTS:
: 8

* Queries against NFDI4BI-KG
:PROPERTIES:
:ID:       88e593e5-defe-4211-ab3d-c407739d75f7
:END:

** spo
:PROPERTIES:
:ID:       bd5e3d52-41fe-4676-b6bf-78a0be8a0a55
:END:
#+begin_src sparql :url http://193.196.20.26:3030/N4BIKG/sparql
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  prefix dcite: <https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#>
  select ?s ?p ?plabel ?o ?olabel where 
  {
    ?s ?p ?o
    optional {
      ?p rdfs:label ?plabel.
    }
    optional {
      ?o rdfs:label ?olabel .
    }
  }
  limit 10
#+end_src

#+RESULTS:
| s                                            | p                                                                     | plabel  | o                                                | olabel |
|----------------------------------------------+-----------------------------------------------------------------------+---------+--------------------------------------------------+--------|
| https://zenodo.org/communities/nfdi4bioimage | http://purl.org/dc/elements/1.1/identifier                            |         | nfdi4bioimage                                    |        |
| https://zenodo.org/communities/nfdi4bioimage | https://nfdi.fiz-karlsruhe.de/ontology/NFDI_0001008                   | has url | https://zenodo.org/communities/nfdi4bioimage     |        |
| http://purl.org/dc/elements/1.1/identifier   | http://www.w3.org/1999/02/22-rdf-syntax-ns#type                       |         | http://www.w3.org/2002/07/owl#AnnotationProperty |        |
| https://doi.org/10.1038/s41598-019-56067-w   | https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#IsPartOf     |         | https://zenodo.org/communities/nfdi4bioimage/    |        |
| https://doi.org/10.1038/s41598-019-56067-w   | https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#Issued       |         | 2019-12-20                                       |        |
| https://doi.org/10.1038/s41598-019-56067-w   | https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#Updated      |         | 2023-02-02                                       |        |
| https://doi.org/10.1038/s41598-019-56067-w   | https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#creator      |         | https://orcid.org/0000-0002-8367-5163            |        |
| https://doi.org/10.1038/s41598-019-56067-w   | https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#resourceType |         | None                                             |        |
| https://doi.org/10.1038/s41598-019-56067-w   | https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#right        |         | Creative Commons Attribution 4.0 International   |        |
| https://doi.org/10.1038/s41598-019-56067-w   | https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#subject      |         | FLIM, sdt, image analysis                        |        |

** Creators and contributors for a record
:PROPERTIES:
:ID:       bd5e3d52-41fe-4676-b6bf-78a0be8a0a55
:END:
#+begin_src sparql :url http://193.196.20.26:3030/N4BIKG/sparql
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  prefix dcite: <https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#>
  prefix nfdicore: <https://nfdi.fiz-karlsruhe.de/ontology/>
  select *
  where
  {
    <https://doi.org/10.5281/zenodo.14013026> dcite:contributor ?contributor ;
                                              dcite:creator ?creator .
  }
#+end_src

#+RESULTS:
| contributor | creator                               |
|-------------+---------------------------------------|
| b0          | https://orcid.org/0000-0001-9568-895X |
| b0          | https://orcid.org/0000-0001-7734-3771 |
| b0          | https://orcid.org/0000-0001-6523-7496 |
| b0          | b1                                    |
| b0          | b2                                    |
** Count number of creators and contributors per record.
:PROPERTIES:
:ID:       bd5e3d52-41fe-4676-b6bf-78a0be8a0a55
:END:
#+begin_src sparql :url http://193.196.20.26:3030/N4BIKG/sparql
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  prefix dcite: <https://schema.datacite.org/meta/kernel-4.6/metadata.xsd#>
  prefix nfdicore: <https://nfdi.fiz-karlsruhe.de/ontology/>
  select ?record (count(distinct ?creator) as ?ncreators) (count(distinct ?contributor) as ?ncontributor)
  where
  {
    ?record dcite:contributor ?contributor ;
            dcite:creator ?creator .
  }
  group by ?record
#+end_src

#+RESULTS:
| record                                     | ncreators | ncontributor |
|--------------------------------------------+-----------+--------------|
| https://doi.org/10.5281/zenodo.11502721    |         1 |            9 |
| https://doi.org/10.5281/zenodo.5101158     |         1 |            1 |
| https://doi.org/10.5281/zenodo.15308773    |         1 |            2 |
| https://doi.org/10.5281/zenodo.14937632    |         1 |            1 |
| https://doi.org/10.5281/zenodo.11031747    |         1 |            1 |
| https://doi.org/10.1038/s41598-019-56067-w |         1 |            1 |
| https://doi.org/10.5281/zenodo.14178789    |         5 |            1 |
| https://doi.org/10.5281/zenodo.14951142    |         1 |            3 |
| https://doi.org/10.5281/zenodo.14044640    |        10 |            1 |
| https://doi.org/10.5281/zenodo.11350689    |         3 |            2 |
| https://doi.org/10.5281/zenodo.15225616    |         1 |            3 |
| https://doi.org/10.5281/zenodo.14044380    |         9 |            1 |
| https://doi.org/10.5281/zenodo.11109616    |         3 |            1 |
| https://doi.org/10.5281/zenodo.14909526    |        10 |            1 |
| https://doi.org/10.5281/zenodo.15373555    |         3 |            2 |
| https://doi.org/10.5281/zenodo.14186101    |         1 |            5 |
| https://doi.org/10.5281/zenodo.14013026    |         5 |            1 |
